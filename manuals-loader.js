// --- ฐานข้อมูลรายการ Manuals ---
const manualDatabase = {
    'lk2': {
        name: 'LK2',
        files: [
            { name: 'LK2_2700C_Analyser_Service_Manual.pdf', path: 'documents/LK2/LK2_2700C_Analyser_Service_Manual.pdf', displayName: '2700C Analyser Service Manual' },
            { name: 'LK2_adam_4000_manual.pdf', path: 'documents/LK2/LK2_adam_4000_manual.pdf', displayName: 'Adam 4000 Manual' },
            { name: 'LK2_Analytical_Diaphragm_Pump_MP30.pdf', path: 'documents/LK2/LK2_Analytical_Diaphragm_Pump_MP30.pdf', displayName: 'Analytical Diaphragm Pump MP30' },
            { name: 'LK2_CO_O2_ZRJ.pdf', path: 'documents/LK2/LK2_CO_O2_ZRJ.pdf', displayName: 'CO,O2 ZRJ' },
            { name: 'LK2_Cooler_M_ECP3000_EN.pdf', path: 'documents/LK2/LK2_Cooler_M_ECP3000_EN.pdf', displayName: 'Cooler M ECP3000 EN' },
            { name: 'LK2_Dust_Hunter_T100.pdf', path: 'documents/LK2/LK2_Dust_Hunter_T100.pdf', displayName: 'Dust-Hunter T100' },
            { name: 'LK2_H2S_T101_Manual.pdf', path: 'documents/LK2/LK2_H2S_T101_Manual.pdf', displayName: 'H2S T101 Manual' },
            { name: 'LK2_Heated_line.pdf', path: 'documents/LK2/LK2_Heated_line.pdf', displayName: 'Heated line' },
            { name: 'LK2_Liquid_Particle_Filter_CLF-5.pdf', path: 'documents/LK2/LK2_Liquid_Particle_Filter_CLF-5.pdf', displayName: 'Liquid Particle Filter CLF-5' },
            { name: 'LK2_Liquid_stop_M_LB1_EN.pdf', path: 'documents/LK2/LK2_Liquid_stop_M_LB1_EN.pdf', displayName: 'Liquid stop M LB1 EN' },
            { name: 'LK2_MSDS_H2O2.pdf', path: 'documents/LK2/LK2_MSDS_H2O2.pdf', displayName: 'MSDS H2O2' },
            { name: 'LK2_NOx_T200HM.pdf', path: 'documents/LK2/LK2_NOx_T200HM.pdf', displayName: 'NOx T200HM' },
            { name: 'LK2_Operation_manual_EX9017.pdf', path: 'documents/LK2/LK2_Operation_manual_EX9017.pdf', displayName: 'Operation manual EX9017' },
            { name: 'LK2_Oxitec_5000_Oxygen_Analyser.pdf', path: 'documents/LK2/LK2_Oxitec_5000_Oxygen_Analyser.pdf', displayName: 'Oxitec 5000 Oxygen Analyser' },
            { name: 'LK2_OXITEC_13_142_EN.pdf', path: 'documents/LK2/LK2_OXITEC_13_142_EN.pdf', displayName: 'OXITEC 13 142 EN' },
            { name: 'LK2_Peristaltic_pump_SR25_1.pdf', path: 'documents/LK2/LK2_Peristaltic_pump_SR25_1.pdf', displayName: 'Peristaltic pump SR25.1' },
            { name: 'LK2_Peristaltic_pump_1rpm_SR25.pdf', path: 'documents/LK2/LK2_Peristaltic_pump_1rpm_SR25.pdf', displayName: 'Peristaltic pump 1rpm SR25' },
            { name: 'LK2_Peristaltic_pump_5rpm_SR25.pdf', path: 'documents/LK2/LK2_Peristaltic_pump_5rpm_SR25.pdf', displayName: 'Peristaltic pump 5rpm SR25' },
            { name: 'LK2_PPD_MD_Series_Manual.pdf', path: 'documents/LK2/LK2_PPD_MD_Series_Manual.pdf', displayName: 'PPD MD-Series Manual' },
            { name: 'LK2_Probe_model_M_SP2200.pdf', path: 'documents/LK2/LK2_Probe_model_M_SP2200.pdf', displayName: 'Probe model M SP2200' },
            { name: 'LK2_RC22_Manual.pdf', path: 'documents/LK2/LK2_RC22_Manual.pdf', displayName: 'RC22 Manual' },
            { name: 'LK2_sampline_probe_PDS_JES301.pdf', path: 'documents/LK2/LK2_sampline_probe_PDS_JES301.pdf', displayName: 'sampline probe PDS JES301' },
            { name: 'LK2_SO2_analyzer_T100H.pdf', path: 'documents/LK2/LK2_SO2_analyzer_T100H.pdf', displayName: 'SO2 analyzer T100H' },
            { name: 'LK2_TRS_T102.pdf', path: 'documents/LK2/LK2_TRS_T102.pdf', displayName: 'TRS T102' },
            { name: 'LK2_TRS_H2S_USER_NVS_T101_T102.pdf', path: 'documents/LK2/LK2_TRS_H2S_USER_NVS_T101_T102.pdf', displayName: 'TRS,H2S, USER, NVS, T101-T102' },
            { name: 'LK2_Ultra_fine_filter_FP.pdf', path: 'documents/LK2/LK2_Ultra_fine_filter_FP.pdf', displayName: 'Ultra-fine filter FP' },
            { name: 'LK2_Universal_Filter_FP-2T-D.pdf', path: 'documents/LK2/LK2_Universal_Filter_FP-2T-D.pdf', displayName: 'Universal Filter FP-2T-D' }
        ]
    },
    'pp11': {
        name: 'PP11',
        files: [
            { name: 'PP11_2700C_Analyser_Service_Manual.pdf', path: 'documents/PP11/PP11_2700C_Analyser_Service_Manual.pdf', displayName: '2700C Analyser Service Manual' },
            { name: 'PP11_adam_4000_manual.pdf', path: 'documents/PP11/PP11_adam_4000_manual.pdf', displayName: 'Adam 4000 Manual' },
            { name: 'PP11_Analytical_Diaphragm_Pump_MP30.pdf', path: 'documents/PP11/PP11_Analytical_Diaphragm_Pump_MP30.pdf', displayName: 'Analytical Diaphragm Pump MP30' },
            { name: 'PP11_CO_M300E.pdf', path: 'documents/PP11/PP11_CO_M300E.pdf', displayName: 'CO M300E' },
            { name: 'PP11_Cooler_M_ECP3000_EN.pdf', path: 'documents/PP11/PP11_Cooler_M_ECP3000_EN.pdf', displayName: 'Cooler M ECP3000 EN' },
            { name: 'PP11_H2S_M101E.pdf', path: 'documents/PP11/PP11_H2S_M101E.pdf', displayName: 'H2S M101E' },
            { name: 'PP11_Heated_line.pdf', path: 'documents/PP11/PP11_Heated_line.pdf', displayName: 'Heated line' },
            { name: 'PP11_JUMO_ETRON_TYPE_701050.pdf', path: 'documents/PP11/PP11_JUMO_ETRON_TYPE_701050.pdf', displayName: 'JUMO ETRON TYPE 701050' },
            { name: 'PP11_Liquid_Particle_Filter_CLF-5.pdf', path: 'documents/PP11/PP11_Liquid_Particle_Filter_CLF-5.pdf', displayName: 'Liquid Particle Filter CLF-5' },
            { name: 'PP11_Liquid_stop_M_LB1_EN.pdf', path: 'documents/PP11/PP11_Liquid_stop_M_LB1_EN.pdf', displayName: 'Liquid stop M LB1 EN' },
            { name: 'PP11_NOx_Gasboard_3000_plus.pdf', path: 'documents/PP11/PP11_NOx_Gasboard_3000_plus.pdf', displayName: 'NOx Gasboard 3000 plus' },
            { name: 'PP11_O2_ZRJ.pdf', path: 'documents/PP11/PP11_O2_ZRJ.pdf', displayName: 'O2 ZRJ' },
            { name: 'PP11_O2_analyzer_ZFK7.pdf', path: 'documents/PP11/PP11_O2_analyzer_ZFK7.pdf', displayName: 'O2 analyzer ZFK7' },
            { name: 'PP11_Opacity_opal_200_ms.pdf', path: 'documents/PP11/PP11_Opacity_opal_200_ms.pdf', displayName: 'Opacity opal 200 ms' },
            { name: 'PP11_Peristaltic_pump_1rpm_SR25.pdf', path: 'documents/PP11/PP11_Peristaltic_pump_1rpm_SR25.pdf', displayName: 'Peristaltic pump 1rpm SR25' },
            { name: 'PP11_Peristaltic_pump_5rpm_SR25.pdf', path: 'documents/PP11/PP11_Peristaltic_pump_5rpm_SR25.pdf', displayName: 'Peristaltic pump 5rpm SR25' },
            { name: 'PP11_PPD_MD_Series_Manual.pdf', path: 'documents/PP11/PP11_PPD_MD_Series_Manual.pdf', displayName: 'PPD MD-Series Manual' },
            { name: 'PP11_Probe_model_M_SP2200.pdf', path: 'documents/PP11/PP11_Probe_model_M_SP2200.pdf', displayName: 'Probe model M SP2200' },
            { name: 'PP11_Purge_Air_Requirements.pdf', path: 'documents/PP11/PP11_Purge_Air_Requirements.pdf', displayName: 'Purge Air Requirements' },
            { name: 'PP11_sampline_probe_PDS_JES301.pdf', path: 'documents/PP11/PP11_sampline_probe_PDS_JES301.pdf', displayName: 'sampline probe PDS JES301' },
            { name: 'PP11_T100H_SO2.pdf', path: 'documents/PP11/PP11_T100H_SO2.pdf', displayName: 'T100H SO2' },
            { name: 'PP11_TRS_102E.pdf', path: 'documents/PP11/PP11_TRS_102E.pdf', displayName: 'TRS 102E' },
            { name: 'PP11_Ultra_fine_filter_FP.pdf', path: 'documents/PP11/PP11_Ultra_fine_filter_FP.pdf', displayName: 'Ultra-fine filter FP' },
            { name: 'PP11_Universal_Filter_FP-2T-D.pdf', path: 'documents/PP11/PP11_Universal_Filter_FP-2T-D.pdf', displayName: 'Universal Filter FP-2T-D' },
            { name: 'PP11_Wash_bottle_D_FPW_EN.pdf', path: 'documents/PP11/PP11_Wash_bottle_D_FPW_EN.pdf', displayName: 'Wash bottle D FPW EN' }
        ]
    },
    'lk1': {
        name: 'LK1',
        files: [
            { name: 'LK1_adam_4000_manual.pdf', path: 'documents/LK1/LK1_adam_4000_manual.pdf', displayName: 'Adam 4000 Manual' },
            { name: 'LK1_Analytical_Diaphragm_Pump_MP30.pdf', path: 'documents/LK1/LK1_Analytical_Diaphragm_Pump_MP30.pdf', displayName: 'Analytical Diaphragm Pump MP30' },
            { name: 'LK1_CHECK_VALVE_SPCV.pdf', path: 'documents/LK1/LK1_CHECK_VALVE_SPCV.pdf', displayName: 'CHECK VALVE SPCV' },
            { name: 'LK1_Cooler_M_ECP3000_EN.pdf', path: 'documents/LK1/LK1_Cooler_M_ECP3000_EN.pdf', displayName: 'Cooler M ECP3000 EN' },
            { name: 'LK1_Dust_Hunter_T100.pdf', path: 'documents/LK1/LK1_Dust_Hunter_T100.pdf', displayName: 'Dust-Hunter T100' },
            { name: 'LK1_Filter_DE410008.pdf', path: 'documents/LK1/LK1_Filter_DE410008.pdf', displayName: 'Filter DE410008' },
            { name: 'LK1_flow_switch_PF2A710.pdf', path: 'documents/LK1/LK1_flow_switch_PF2A710.pdf', displayName: 'Flow Switch PF2A710' },
            { name: 'LK1_Headed_probe_de461021.pdf', path: 'documents/LK1/LK1_Headed_probe_de461021.pdf', displayName: 'Headed Probe de461021' },
            { name: 'LK1_Heated_line.pdf', path: 'documents/LK1/LK1_Heated_line.pdf', displayName: 'Heated line' },
            { name: 'LK1_JUMO_ETRON_TYPE_701050.pdf', path: 'documents/LK1/LK1_JUMO_ETRON_TYPE_701050.pdf', displayName: 'JUMO ETRON TYPE 701050' },
            { name: 'LK1_Liquid_Particle_Filter_CLF-5.pdf', path: 'documents/LK1/LK1_Liquid_Particle_Filter_CLF-5.pdf', displayName: 'Liquid Particle Filter CLF-5' },
            { name: 'LK1_Liquid_stop_M_LB1_EN.pdf', path: 'documents/LK1/LK1_Liquid_stop_M_LB1_EN.pdf', displayName: 'Liquid stop M LB1 EN' },
            { name: 'LK1_Male_Elbow_Super_Lok.pdf', path: 'documents/LK1/LK1_Male_Elbow_Super_Lok.pdf', displayName: 'Male Elbow Super Lok' },
            { name: 'LK1_Moisture_controller_BE410002.pdf', path: 'documents/LK1/LK1_Moisture_controller_BE410002.pdf', displayName: 'Moisture controller BE410002' },
            { name: 'LK1_Moisture_sensor_DA410011.pdf', path: 'documents/LK1/LK1_Moisture_sensor_DA410011.pdf', displayName: 'Moisture sensor DA410011' },
            { name: 'LK1_MSDS_H2O2.pdf', path: 'documents/LK1/LK1_MSDS_H2O2.pdf', displayName: 'MSDS H2O2' },
            { name: 'LK1_Neflon_Gas_Dryer.pdf', path: 'documents/LK1/LK1_Neflon_Gas_Dryer.pdf', displayName: 'Neflon Gas Dryer' },
            { name: 'LK1_O2_analyzer_ZFK7.pdf', path: 'documents/LK1/LK1_O2_analyzer_ZFK7.pdf', displayName: 'O2 analyzer ZFK7' },
            { name: 'LK1_Operation_manual_EX9017.pdf', path: 'documents/LK1/LK1_Operation_manual_EX9017.pdf', displayName: 'Operation manual EX9017' },
            { name: 'LK1_Oxitec_5000_Oxygen_Analyser.pdf', path: 'documents/LK1/LK1_Oxitec_5000_Oxygen_Analyser.pdf', displayName: 'Oxitec 5000 Oxygen Analyser' },
            { name: 'LK1_OXITEC_13_142_EN.pdf', path: 'documents/LK1/LK1_OXITEC_13_142_EN.pdf', displayName: 'OXITEC 13_142 EN' },
            { name: 'LK1_Peristaltic_pump_1rpm_SR25.pdf', path: 'documents/LK1/LK1_Peristaltic_pump_1rpm_SR25.pdf', displayName: 'Peristaltic pump 1rpm SR25' },
            { name: 'LK1_Peristaltic_pump_5rpm_SR25.pdf', path: 'documents/LK1/LK1_Peristaltic_pump_5rpm_SR25.pdf', displayName: 'Peristaltic pump 5rpm SR25' },
            { name: 'LK1_Power_supply_MWEC.pdf', path: 'documents/LK1/LK1_Power_supply_MWEC.pdf', displayName: 'Power supply MWEC' },
            { name: 'LK1_PPD_MD_Series_Manual.pdf', path: 'documents/LK1/LK1_PPD_MD_Series_Manual.pdf', displayName: 'PPD MD-Series Manual' },
            { name: 'LK1_Probe_model_M_SP2200.pdf', path: 'documents/LK1/LK1_Probe_model_M_SP2200.pdf', displayName: 'Probe model M SP2200' },
            { name: 'LK1_RC22_Manual.pdf', path: 'documents/LK1/LK1_RC22_Manual.pdf', displayName: 'RC22 Manual' },
            { name: 'LK1_Regenerative_Dryer_HD.pdf', path: 'documents/LK1/LK1_Regenerative_Dryer_HD.pdf', displayName: 'Regenerative Dryer HD' },
            { name: 'LK1_REGULATOR_AW_OMS0038.pdf', path: 'documents/LK1/LK1_REGULATOR_AW_OMS0038.pdf', displayName: 'REGULATOR AW-OMS0038' },
            { name: 'LK1_Relay_pyf08a.pdf', path: 'documents/LK1/LK1_Relay_pyf08a.pdf', displayName: 'Relay pyf08a' },
            { name: 'LK1_SUT_Unions_Tees.pdf', path: 'documents/LK1/LK1_SUT_Unions_Tees.pdf', displayName: 'SUT-Unions-Tees' },
            { name: 'LK1_Universal_Filter_FP_2T_D.pdf', path: 'documents/LK1/LK1_Universal_Filter_FP_2T_D.pdf', displayName: 'Universal Filter FP-2T-D' },
            { name: 'LK1_ZPA_NDIR_Analyzer.pdf', path: 'documents/LK1/LK1_ZPA_NDIR_Analyzer.pdf', displayName: 'ZPA NDIR Analyzer' },
            { name: 'LK1_Connector_Superlok.pdf', path: 'documents/LK1/LK1_Connector_Superlok.pdf', displayName: 'Connector Superlok' }
        ]
    },
    'pp5': {
        name: 'PP5',
        files: [
            { name: 'PP5_2700C_Analyser_Service_Manual.pdf', path: 'documents/PP5/PP5_2700C_Analyser_Service_Manual.pdf', displayName: '2700C Analyser Service Manual' },
            { name: 'PP5_adam_4000_manual.pdf', path: 'documents/PP5/PP5_adam_4000_manual.pdf', displayName: 'Adam 4000 Manual' },
            { name: 'PP5_Analytical_Diaphragm_Pump_MP30.pdf', path: 'documents/PP5/PP5_Analytical_Diaphragm_Pump_MP30.pdf', displayName: 'Analytical Diaphragm Pump MP30' },
            { name: 'PP5_CO_O2_ZRJ.pdf', path: 'documents/PP5/PP5_CO_O2_ZRJ.pdf', displayName: 'CO,O2 ZRJ' },
            { name: 'PP5_Cooler_M_ECP3000_EN.pdf', path: 'documents/PP5/PP5_Cooler_M_ECP3000_EN.pdf', displayName: 'Cooler M ECP3000 EN' },
            { name: 'PP5_Dust_D_cem_service_manual.pdf', path: 'documents/PP5/PP5_Dust_D_cem_service_manual.pdf', displayName: 'Dust D cem - service manual' },
            { name: 'PP5_Heated_line.pdf', path: 'documents/PP5/PP5_Heated_line.pdf', displayName: 'Heated line' },
            { name: 'PP5_JUMO_ETRON_TYPE_701050.pdf', path: 'documents/PP5/PP5_JUMO_ETRON_TYPE_701050.pdf', displayName: 'JUMO ETRON TYPE 701050' },
            { name: 'PP5_Liquid_Particle_Filter_CLF-5.pdf', path: 'documents/PP5/PP5_Liquid_Particle_Filter_CLF-5.pdf', displayName: 'Liquid Particle Filter CLF-5' },
            { name: 'PP5_Liquid_stop_M_LB1_EN.pdf', path: 'documents/PP5/PP5_Liquid_stop_M_LB1_EN.pdf', displayName: 'Liquid stop M LB1 EN' },
            { name: 'PP5_Moisture_controler_LA1_EN.pdf', path: 'documents/PP5/PP5_Moisture_controler_LA1_EN.pdf', displayName: 'Moisture controler LA1 EN' },
            { name: 'PP5_O2_analyzer_ZFK7.pdf', path: 'documents/PP5/PP5_O2_analyzer_ZFK7.pdf', displayName: 'O2 analyzer ZFK7' },
            { name: 'PP5_Peristaltic_pump_5rpm_SR25.pdf', path: 'documents/PP5/PP5_Peristaltic_pump_5rpm_SR25.pdf', displayName: 'Peristaltic pump 5rpm SR25' },
            { name: 'PP5_PPD_MD_Series_Manual.pdf', path: 'documents/PP5/PP5_PPD_MD_Series_Manual.pdf', displayName: 'PPD MD-Series Manual' },
            { name: 'PP5_Probe_model_M_SP2200.pdf', path: 'documents/PP5/PP5_Probe_model_M_SP2200.pdf', displayName: 'Probe model M SP2200' },
            { name: 'PP5_RC22_Manual.pdf', path: 'documents/PP5/PP5_RC22_Manual.pdf', displayName: 'RC22 Manual' },
            { name: 'PP5_sampling_probe_PDS_JES301.pdf', path: 'documents/PP5/PP5_sampling_probe_PDS_JES301.pdf', displayName: 'sampling probe PDS JES301' },
            { name: 'PP5_Universal_Filter_FP-2T-D.pdf', path: 'documents/PP5/PP5_Universal_Filter_FP-2T-D.pdf', displayName: 'Universal Filter FP-2T-D' },
            { name: 'PP5_ZPA_NDIR_Analyzer.pdf', path: 'documents/PP5/PP5_ZPA_NDIR_Analyzer.pdf', displayName: 'ZPA NDIR Analyzer' }
        ]
    },
    'pp6': {
        name: 'PP6',
        files: [
            { name: 'PP6_2700C_Analyser_Service_Manual.pdf', path: 'documents/PP6/PP6_2700C_Analyser_Service_Manual.pdf', displayName: '2700C Analyser Service Manual' },
            { name: 'PP6_adam_4000_manual.pdf', path: 'documents/PP6/PP6_adam_4000_manual.pdf', displayName: 'Adam 4000 Manual' },
            { name: 'PP6_Analytical_Diaphragm_Pump_MP30.pdf', path: 'documents/PP6/PP6_Analytical_Diaphragm_Pump_MP30.pdf', displayName: 'Analytical Diaphragm Pump MP30' },
            { name: 'PP6_CO_O2_ZRJ.pdf', path: 'documents/PP6/PP6_CO_O2_ZRJ.pdf', displayName: 'CO,O2 ZRJ' },
            { name: 'PP6_Compressed_Air_Kit_Manual_V1.pdf', path: 'documents/PP6/PP6_Compressed_Air_Kit_Manual_V1.pdf', displayName: 'Compressed Air Kit Manual V1' },
            { name: 'PP6_Cooler_M_ECP3000_EN.pdf', path: 'documents/PP6/PP6_Cooler_M_ECP3000_EN.pdf', displayName: 'Cooler M ECP3000 EN' },
            { name: 'PP6_DSCU_Installation_Operators_Manual.pdf', path: 'documents/PP6/PP6_DSCU_Installation_Operators_Manual.pdf', displayName: 'DSCU Installation & Operators Manual' },
            { name: 'PP6_DSL_460_MkII_Installation_Manual.pdf', path: 'documents/PP6/PP6_DSL_460_MkII_Installation_Manual.pdf', displayName: 'DSL-460 MkII Installation Manual' },
            { name: 'PP6_DSL_460_MkII_Operators_Manual.pdf', path: 'documents/PP6/PP6_DSL_460_MkII_Operators_Manual.pdf', displayName: 'DSL-460 MkII Operators Manual' },
            { name: 'PP6_H2S_T101.pdf', path: 'documents/PP6/PP6_H2S_T101.pdf', displayName: 'H2S T101' },
            { name: 'PP6_Heated_line.pdf', path: 'documents/PP6/PP6_Heated_line.pdf', displayName: 'Heated line' },
            { name: 'PP6_JUMO_ETRON_TYPE_701050.pdf', path: 'documents/PP6/PP6_JUMO_ETRON_TYPE_701050.pdf', displayName: 'JUMO ETRON TYPE 701050' },
            { name: 'PP6_Liquid_particle_Filter_CLF-5.pdf', path: 'documents/PP6/PP6_Liquid_particle_Filter_CLF-5.pdf', displayName: 'Liquid particle Filter CLF-5' },
            { name: 'PP6_Liquid_stop_M_LB1_EN.pdf', path: 'documents/PP6/PP6_Liquid_stop_M_LB1_EN.pdf', displayName: 'Liquid stop M LB1 EN' },
            { name: 'PP6_NOx-200E.pdf', path: 'documents/PP6/PP6_NOx-200E.pdf', displayName: 'NOx-200E' },
            { name: 'PP6_O2_analyzer_ZFK7.pdf', path: 'documents/PP6/PP6_O2_analyzer_ZFK7.pdf', displayName: 'O2 analyzer ZFK7' },
            { name: 'PP6_Peristaltic_pump_1rpm_SR25.pdf', path: 'documents/PP6/PP6_Peristaltic_pump_1rpm_SR25.pdf', displayName: 'Peristaltic pump 1rpm SR25' },
            { name: 'PP6_Peristaltic_pump_5rpm_SR25.pdf', path: 'documents/PP6/PP6_Peristaltic_pump_5rpm_SR25.pdf', displayName: 'Peristaltic pump 5rpm SR25' },
            { name: 'PP6_PPD_MD_Series_Manual.pdf', path: 'documents/PP6/PP6_PPD_MD_Series_Manual.pdf', displayName: 'PPD MD-Series Manual' },
            { name: 'PP6_Probe_model_M_SP2200.pdf', path: 'documents/PP6/PP6_Probe_model_M_SP2200.pdf', displayName: 'Probe model M SP2200' },
            { name: 'PP6_Purge_Air_Requirements.pdf', path: 'documents/PP6/PP6_Purge_Air_Requirements.pdf', displayName: 'Purge Air Requirements' },
            { name: 'PP6_sampline_probe_PDS_JES301.pdf', path: 'documents/PP6/PP6_sampline_probe_PDS_JES301.pdf', displayName: 'sampline probe PDS JES301' },
            { name: 'PP6_SO2_T100_NVS_Manual.pdf', path: 'documents/PP6/PP6_SO2_T100_NVS_Manual.pdf', displayName: 'SO2 T100 NVS Manual' },
            { name: 'PP6_T102_Addendum.pdf', path: 'documents/PP6/PP6_T102_Addendum.pdf', displayName: 'T102 Addendum' },
            { name: 'PP6_Ultra_fine_filter_FP.pdf', path: 'documents/PP6/PP6_Ultra_fine_filter_FP.pdf', displayName: 'Ultra-fine filter FP' },
            { name: 'PP6_Universal_Filter_FP-2T-D.pdf', path: 'documents/PP6/PP6_Universal_Filter_FP-2T-D.pdf', displayName: 'Universal Filter FP-2T-D' },
            { name: 'PP6_Wash_bottle_D_FPW_EN.pdf', path: 'documents/PP6/PP6_Wash_bottle_D_FPW_EN.pdf', displayName: 'Wash bottle D FPW EN' }
        ]
    },
    'kappa': {
        name: 'Kappa',
        files: [
            { name: '002_Valmet_Kappa_Q_ServiceTool_ENG_V3.pdf', path: 'documents/Kappa/002_Valmet_Kappa_Q_ServiceTool_ENG_V3.pdf', displayName: 'Valmet Kappa Q ServiceTool' },
            { name: 'Kappa_QC_spare_parts_catalogue.pdf', path: 'documents/Kappa/Kappa_QC_spare_parts_catalogue.pdf', displayName: 'Kappa QC Spare Parts Catalogue' },
            { name: 'KAPPAC_TM_part1_EN.pdf', path: 'documents/Kappa/KAPPAC_TM_part1_EN.pdf', displayName: 'KAPPAC TM Part 1' },   
            { name: 'KAPPAC_TM_part2_EN.pdf', path: 'documents/Kappa/KAPPAC_TM_part2_EN.pdf', displayName: 'KAPPAC TM Part 2' },
            { name: 'KAPPAC_TM_part3_EN.pdf', path: 'documents/Kappa/KAPPAC_TM_part3_EN.pdf', displayName: 'KAPPAC TM Part 3' },
            { name: 'KappaQC_installation_manual.pdf', path: 'documents/Kappa/KappaQC_installation_manual.pdf', displayName: 'KappaQC Installation Manual' },
            { name: 'KappaQC_owner_manual_K03303_V2-51_EN.pdf', path: 'documents/Kappa/KappaQC_owner_manual_K03303_V2-51_EN.pdf', displayName: 'KappaQC Owner Manual (K03303)' },
            { name: 'moeller-df51-manual.pdf', path: 'documents/Kappa/moeller-df51-manual.pdf', displayName: 'Moeller DF51 Manual' },
            { name: 'SD50X_manual_K06635_V1-1_EN.pdf', path: 'documents/Kappa/SD50X_manual_K06635_V1-1_EN.pdf', displayName: 'SD50X Manual (K06635)' }
        ]
    },
    'pp10': {
        name: 'PP10',
        files: [
            { name: 'Dust D cem - service manual.pdf', path: 'documents/PP10/Dust D cem - service manual.pdf', displayName: 'Dust D cem - Service Manual' },
            { name: 'Filter-DE410008_K-AGF-PV-30-A.pdf', path: 'documents/PP10/Filter-DE410008_K-AGF-PV-30-A.pdf', displayName: 'Filter DE410008' },
            { name: 'Flow switch LHP-125-0.pdf', path: 'documents/PP10/Flow switch LHP-125-0.pdf', displayName: 'Flow Switch LHP-125-0' },
            { name: 'Heated_probe_DE461021.pdf', path: 'documents/PP10/Heated_probe_DE461021.pdf', displayName: 'Heated Probe DE461021' },
            { name: 'Male Elbow Super Lok SME-4-2N-SS.pdf', path: 'documents/PP10/Male Elbow Super Lok SME-4-2N-SS.pdf', displayName: 'Male Elbow Super Lok' },
            { name: 'Moisture controllerBE410002_FF-xx.pdf', path: 'documents/PP10/Moisture controllerBE410002_FF-xx.pdf', displayName: 'Moisture Controller BE410002' },
            { name: 'Moisture sensor DA410011_FF.pdf', path: 'documents/PP10/Moisture sensor DA410011_FF.pdf', displayName: 'Moisture Sensor DA410011' },
            { name: 'Neflon Gas Dryer.pdf', path: 'documents/PP10/Neflon Gas Dryer.pdf', displayName: 'Neflon Gas Dryer' },
            { name: 'O2 analyzer ZFK7-TN4ZFK7a-en.pdf', path: 'documents/PP10/O2 analyzer ZFK7-TN4ZFK7a-en.pdf', displayName: 'O2 Analyzer ZFK7' },
            { name: 'PP10_Power_Supply_MWEC.pdf', path: 'documents/PP10/PP10_Power_Supply_MWEC.pdf', displayName: 'Power Supply MWEC' },
            { name: 'Pump sampling DE420008_P2.x_P2.8x.pdf', path: 'documents/PP10/Pump sampling DE420008_P2.x_P2.8x.pdf', displayName: 'Pump Sampling DE420008' },
            { name: 'PP10_Regenerative_Dryer_HD.pdf', path: 'documents/PP10/PP10_Regenerative_Dryer_HD.pdf', displayName: 'Regenerative Dryer HD-Series' },
            { name: 'Relay_PYF08A.pdf', path: 'documents/PP10/Relay_PYF08A.pdf', displayName: 'Relay PYF08A' },
            { name: 'Signal_output_SI99.pdf', path: 'documents/PP10/Signal_output_SI99.pdf', displayName: 'Signal Output SI99' },
            { name: 'SUT-Unions-Tees.pdf', path: 'documents/PP10/SUT-Unions-Tees.pdf', displayName: 'SUT Unions Tees' },
            { name: 'PP10_ZPA_NDIR_Analyzer.pdf', path: 'documents/PP10/PP10_ZPA_NDIR_Analyzer.pdf', displayName: 'ZPA NDIR Infrared Gas Analyzer' },
            { name: 'PP10_Connector_Superlok.pdf', path: 'documents/PP10/PP10_Connector_Superlok.pdf', displayName: 'ข้อต่อ Superlok Tube Adapters' },
        ]
    },
    'ql': {
        name: 'QL',
        files: [
            { name: 'CEMS_Drawing_QL.pdf', path: 'documents/ql/CEMS_Drawing_QL.pdf', displayName: 'CEMS Drawing QL' },
            { name: 'guide_diaphragm_pump_pu96.txt', path: 'documents/ql/guide_diaphragm_pump_pu96.txt', displayName: 'Guide: Diaphragm Pump PU96' },
            { name: 'guide_reaction_chamber_cleaning.txt', path: 'documents/ql/guide_reaction_chamber_cleaning.txt', displayName: 'Guide: Reaction Chamber Cleaning' },
            { name: 'guide_t100_uv_lamp.txt', path: 'documents/ql/guide_t100_uv_lamp.txt', displayName: 'Guide: T100 UV Lamp' },
            { name: 'guide_t703_leak_check.txt', path: 'documents/ql/guide_t703_leak_check.txt', displayName: 'Guide: T703 Leak Check' },
            { name: 'manual_cooler_ecp3000.pdf', path: 'documents/ql/manual_cooler_ecp3000.pdf', displayName: 'Cooler ECP3000' },
            { name: 'manual_filter_clf5.pdf', path: 'documents/ql/manual_filter_clf5.pdf', displayName: 'Filter CLF-5' },
            { name: 'manual_filter_fp2t.pdf', path: 'documents/ql/manual_filter_fp2t.pdf', displayName: 'Filter FP-2T' },
            { name: 'manual_flow_meter_vfb65.pdf', path: 'documents/ql/manual_flow_meter_vfb65.pdf', displayName: 'Flow Meter VFB-65' },
            { name: 'manual_flow_switch_lph125.pdf', path: 'documents/ql/manual_flow_switch_lph125.pdf', displayName: 'Flow Switch LPH125' },
            { name: 'manual_heated_line.pdf', path: 'documents/ql/manual_heated_line.pdf', displayName: 'Heated Sample Line' },
            { name: 'manual_liquid_stop_lb1.pdf', path: 'documents/ql/manual_liquid_stop_lb1.pdf', displayName: 'Liquid Stop LB-1' },
            { name: 'manual_peristaltic_pump_sr25_5rpm.pdf', path: 'documents/ql/manual_peristaltic_pump_sr25_5rpm.pdf', displayName: 'Peristaltic Pump SR25 (5rpm)' },
            { name: 'manual_peristaltic_pump_sr25.pdf', path: 'documents/ql/manual_peristaltic_pump_sr25.pdf', displayName: 'Peristaltic Pump SR25' },
            { name: 'manual_ppd_md_series.pdf', path: 'documents/ql/manual_ppd_md_series.pdf', displayName: 'PPD MD-Series Manual' },
            { name: 'manual_probe_sp2200.pdf', path: 'documents/ql/manual_probe_sp2200.pdf', displayName: 'Probe SP2200' },
            { name: 'manual_pump_mp30.pdf', path: 'documents/ql/manual_pump_mp30.pdf', displayName: 'Pump MP30' },
            { name: 'msds_h3po4.pdf', path: 'documents/ql/msds_h3po4.pdf', displayName: 'MSDS H3PO4' },
            { name: 'ZFK7-Zirconia-Oxygen-Analyzer.pdf', path: 'documents/ql/ZFK7-Zirconia-Oxygen-Analyzer.pdf', displayName: 'ZFK7 Oxygen Analyzer' },
            { name: 'ZPA NDIR Type Infrared Gas Analyzer.pdf', path: 'documents/ql/ZPA NDIR Type Infrared Gas Analyzer.pdf', displayName: 'ZPA NDIR Gas Analyzer' }
        ]
    }
};

const BACKEND_URL = 'http://localhost:5500';

// ทำให้ฟังก์ชันเป็น async เพื่อรอ fetch ข้อมูล
document.addEventListener('DOMContentLoaded', async () => {

    let manualDatabase = {};
    try {
        console.log("Fetching manual list from server...");
        // 1. ยิง API ไปขอรายการไฟล์ทั้งหมดจาก Server
        const response = await fetch(`${BACKEND_URL}/api/manuals`);
        if (!response.ok) {
            throw new Error('Failed to fetch manual list');
        }
        manualDatabase = await response.json();
        console.log("Successfully fetched manual database from server:", manualDatabase);
    } catch (error) {
        console.error(error);
        const titleElement = document.getElementById('manuals-title');
        if(titleElement) titleElement.textContent = 'Error: ไม่สามารถโหลดรายการคู่มือได้';
        return; // หยุดการทำงานถ้าโหลดไม่สำเร็จ
    }

    // โค้ดส่วนที่เหลือทำงานเหมือนเดิม โดยใช้ manualDatabase ที่เพิ่งดึงมา
    const urlParams = new URLSearchParams(window.location.search);
    const deviceId = (urlParams.get('device') || 'ql').toLowerCase();
    const deviceData = manualDatabase[deviceId];

    const titleElement = document.getElementById('manuals-title');
    const listContainer = document.querySelector('.manuals-list-container');
    const selectElement = document.getElementById('manual-select');

    if (listContainer) listContainer.innerHTML = ''; // Clear existing links
    if (selectElement) selectElement.innerHTML = '<option value="all">คู่มือทั้งหมด</option>';

    if (deviceData) {
        titleElement.textContent = `เลือกคู่มืออ้างอิง (${deviceData.name})`;

        deviceData.files.forEach(file => {
            const pathParts = file.path.split('/');
            const encodedPath = pathParts.map(part => encodeURIComponent(part)).join('/');

            const link = document.createElement('a');
            link.href = `${BACKEND_URL}/${encodedPath}`;

            link.textContent = file.displayName;
            link.target = '_blank';
            link.className = 'button-link';
            listContainer.appendChild(link);

            if (selectElement) {
                const option = document.createElement('option');
                option.value = file.name;
                option.textContent = file.displayName;
                selectElement.appendChild(option);
            }
        });

    } else {
        titleElement.textContent = `ไม่พบข้อมูลอุปกรณ์สำหรับ '${urlParams.get('device')}'`;
        console.log(`Device ID '${deviceId}' not found in database.`);
    }
});